/* Engine.js
 * This file provides the game loop functionality (update entities and render),
 * draws the initial game board on the screen, and then calls the update and
 * render methods on your player and enemy objects (defined in your app.js).
 *
 * A game engine works by drawing the entire game screen over and over, kind of
 * like a flipbook you may have created as a kid. When your player moves across
 * the screen, it may look like just that image/character is moving or being
 * drawn but that is not the case. What's really happening is the entire "scene"
 * is being drawn over and over, presenting the illusion of animation.
 *
 * This engine makes the canvas' context (ctx) object globally available to make
 * writing app.js a little simpler to work with.
 */

var Engine = (function(global) {
    /* Predefine the variables we'll be using within this scope,
     * create the canvas element, grab the 2D context for that canvas
     * set the canvas elements height/width and add it to the DOM.
     */
    var doc = global.document,
        win = global.window,
        canvas = doc.createElement('canvas'),
        ctx = canvas.getContext('2d'),
        lastTime,
        raf;

    canvas.width = 505;
    canvas.height = 606;
    doc.body.appendChild(canvas);

    /* This function serves as the kickoff point for the game loop itself
     * and handles properly calling the update and render methods.
     */
    function main() {
      if(!player.mobile){
        win.cancelAnimationFrame(raf);
      } else {
        /* Get our time delta information which is required if your game
         * requires smooth animation. Because everyone's computer processes
         * instructions at different speeds we need a constant value that
         * would be the same for everyone (regardless of how fast their
         * computer is) - hurray time!
         */
        var now = Date.now(),
            dt = (now - lastTime) / 1000.0;

        /* Call our update/render functions, pass along the time delta to
         * our update function since it may be used for smooth animation.
         */
        update(dt);
        render();

        /* Draw a nice message that declares the player won and give the player
         * the option to play again.
         */
        if(player.won === true){
          drawWinningScreen();
          player.won = false;
        }
        /* Set our lastTime variable which is used to determine the time delta
         * for the next time this function is called.
         */
        lastTime = now;

        /* Use the browser's requestAnimationFrame function to call this
         * function again as soon as the browser is able to draw another frame.
         */
          raf = win.requestAnimationFrame(main);
        }
    }

    /* This function does some initial setup that should only occur once,
     * particularly setting the lastTime variable that is required for the
     * game loop.
     */
    function init() {
        resetGame();
        lastTime = Date.now();
        main();
    }

    /* This function is called by main (our game loop) and itself calls all
     * of the functions which may need to update entity's data. Based on how
     * you implement your collision detection (when two entities occupy the
     * same space, for instance when your character should die), you may find
     * the need to add an additional function call here. For now, we've left
     * it commented out - you may or may not want to implement this
     * functionality this way (you could just implement collision detection
     * on the entities themselves within your app.js file).
     */
    function update(dt) {
        updateEntities(dt);
        checkCollisions();
    }

    /* This is called by the update function and loops through all of the
     * objects within your allEnemies array as defined in app.js and calls
     * their update() methods. It will then call the update function for your
     * player object. These update methods should focus purely on updating
     * the data/properties related to the object. Do your drawing in your
     * render methods.
     */
    function updateEntities(dt) {
        allEnemies.forEach(function(enemy) {
            enemy.update(dt);
        });
        player.update();
    }

    /*  This function loops over all the Enemies and checks if their vertical
     *  position is equal to the Player's vertical position and their horizontal
     *  position is equal to the Player's horizontal position, with a small
     *  margin to account for the empty space in the sprites surrounding both
     *  the player's and the enemy's image.
     *
     *  If they collide, the player's loses() method is called.
     */
    function checkCollisions() {
        allEnemies.forEach(function(enemy) {
            const enemyLeft = enemy.x;
            const enemyRight = enemy.x + 101;
            const playerLeft = player.x;
            const playerRight = player.x + 101;
            const margin = 20;

            if(player.y === enemy.y){
              if((enemyLeft > playerLeft && enemyLeft < (playerRight - margin)) || (enemyRight < playerRight && enemyRight > (playerLeft + margin))) {
                player.loses();
              }
            }
        });
    }

    /* This function initially draws the "game level", it will then call
     * the renderEntities function. Remember, this function is called every
     * game tick (or loop of the game engine) because that's how games work -
     * they are flipbooks creating the illusion of animation but in reality
     * they are just drawing the entire screen over and over.
     */
    function render() {
        /* This array holds the relative URL to the image used
         * for that particular row of the game level.
         */
        var rowImages = [
                'images/grass-block.png',   // Top row is grass
                'images/stone-block.png',   // Row 1 of 3 of stone
                'images/stone-block.png',   // Row 2 of 3 of stone
                'images/water-block.png',   // Row 1 of 1 of water
                'images/stone-block.png',   // Row 3 of 3 of stone
                'images/grass-block.png'    // Row 2 of 2 of grass
            ],
            numRows = 6,
            numCols = 5,
            row, col;

        // Before drawing, clear existing canvas
        ctx.clearRect(0,0,canvas.width,canvas.height)

        /* Loop through the number of rows and columns we've defined above
         * and, using the rowImages array, draw the correct image for that
         * portion of the "grid"
         */
        for (row = 0; row < numRows; row++) {
            for (col = 0; col < numCols; col++) {
                /* The drawImage function of the canvas' context element
                 * requires 3 parameters: the image to draw, the x coordinate
                 * to start drawing and the y coordinate to start drawing.
                 * We're using our Resources helpers to refer to our images
                 * so that we get the benefits of caching these images, since
                 * we're using them over and over.
                 */
                ctx.drawImage(Resources.get(rowImages[row]), col * 101, row * 83);
            }
        }

        renderEntities();
    }

    /* This function is called by the render function and is called on each game
     * tick. Its purpose is to then call the render functions you have defined
     * on your enemy and player entities within app.js
     */
    function renderEntities() {
        /* Loop through all of the objects within the allEnemies array and call
         * the render function you have defined.
         */
        allEnemies.forEach(function(enemy) {
            enemy.render();
        });

        player.render();
    }

    /* This function handles the game reset state, it:
     * - resets the player's image
     * - resets the player's position
     * - makes it possible for the player to move again
     * - generates new speeds for the enemies and lets them move again
     * - starts the animation of the canvas again
     * It's called by the init() function, the clearWinningScreen() function,
     * and by the Player's loses() function. It is assigned to the window object
     * for that last case. (so it can be called from the app.js file)
     */
    window.resetGame = function() {
        player.sprite = 'images/char-boy.png';
        player.x = 202;
        player.y = 397;
        player.mobile = true;
        speeds = [randomSpeed(), randomSpeed(), randomSpeed()];
        allEnemies.forEach(function(enemy, index) {
            const i = index >= 3 ? index >= 6 ? 2 : 1 : 0;
            enemy.speed = speeds[i];
        });
        raf = win.requestAnimationFrame(main);
    }

    /*  Use SVG paths to create a nice message to let the user know they won
     *  and they can reset the game by clicking anywhere.
     */
    function drawWinningScreen(){
      // Put all the SVG paths in an object so I can fold it in my editor
      const graphic = {
        circle : new Path2D(),
        goldCup : new Path2D('M246.567,171c6.511,0,13.025,0,19.536,0c0.346,0.156,0.714,0.135,1.081,0.144c1.035,0.026,2.068,0.027,3.103,0.072c2.005,0.09,4.012,0.205,6.011,0.312c1.369,0.07,2.739,0.135,4.099,0.238c1.881,0.138,3.759,0.304,5.639,0.477c2.117,0.196,4.248,0.374,6.353,0.624c2.539,0.3,5.075,0.645,7.61,0.995c5.243,0.739,10.452,1.702,15.594,2.958c0.321,0.079,0.641,0.165,0.974,0.259c0.354,0.105,0.53,0.367,0.588,0.734c0.073,0.438-0.02,0.852-0.212,1.234c-0.187,0.368-0.234,0.751-0.24,1.15c-0.048,2.038-0.105,4.076-0.146,6.115c-0.028,1.67-0.061,3.346-0.171,5.015c-0.044,0.525,0.023,1.028,0.242,1.512c0.18,0.391,0.24,0.817,0.292,1.241c0.049,0.359,0.112,0.718,0.161,1.083c0.074,0.544,0.394,0.874,0.893,1.05c0.459,0.168,0.932,0.299,1.426,0.312c0.665,0.018,1.333,0.042,1.997,0.004c1.214-0.065,2.34-0.428,3.329-1.13c0.629-0.442,1.238-0.893,1.851-1.343c1.872-1.365,3.733-2.726,5.671-3.984c1.587-1.025,3.219-1.976,4.986-2.676c1.834-0.728,3.746-1.045,5.717-1.003c1.146,0.027,2.305,0.184,3.448,0.319c1.09,0.13,2.138,0.465,3.131,0.941c1.023,0.488,1.973,1.084,2.858,1.784c2.161,1.702,3.878,3.783,5.259,6.138c2.492,4.234,3.951,8.802,4.401,13.698c0.02,0.21,0.075,0.42,0.118,0.629c0,3.285,0,6.57,0,9.859c-0.044,0.239-0.118,0.477-0.123,0.717c-0.025,0.857-0.169,1.694-0.314,2.531c-0.505,3.097-1.245,6.14-2.052,9.168c-2.426,8.986-6.267,17.322-11.47,25.036c-3.743,5.569-8.029,10.705-12.66,15.557c-4.652,4.87-9.583,9.428-14.72,13.778c-6.002,5.071-12.222,9.86-18.595,14.453c-1.878,1.351-3.76,2.694-5.665,4.006c-0.72,0.502-1.054,1.147-1.036,2.001c0.005,0.488,0.023,0.978,0.111,1.455c0.238,1.193,0.47,2.386,0.706,3.589c0.132,0.651,0.134,1.328,0.106,1.996c-0.017,0.368-0.099,0.72-0.261,1.056c-0.394,0.795-1.113,1.038-1.907,0.659c-0.366-0.18-0.653-0.448-0.914-0.746c-0.616-0.732-1.043-1.576-1.377-2.457c-0.666-1.817-1.092-3.675-1.09-5.619c0-0.196,0.099-0.425-0.168-0.625c-0.171,0.292-0.332,0.573-0.474,0.863c-2.714,5.256-5.715,10.331-9.173,15.141c-2.555,3.558-5.36,6.922-8.467,10.036c-1.862,1.877-3.844,3.635-5.942,5.248c-0.267,0.207-0.526,0.419-0.781,0.637c-0.167,0.152-0.244,0.356-0.213,0.576c0.177,1.029,0.025,2.069,0.127,3.098c0.15,1.472,0.021,2.916-0.048,4.383c-0.013,0.455-0.086,0.905-0.241,1.338c-0.107,0.332-0.277,0.648-0.63,0.736c-0.594,0.159-0.929,0.526-1.065,1.112c-0.027,0.147-0.133,0.271-0.218,0.396c-0.187,0.263-0.239,0.555-0.253,0.867c-0.005,0.271-0.01,0.541-0.01,0.82c0.01,3.583-0.073,7.179,0.193,10.77c0.102,1.302,0.146,2.604,0.263,3.915c0.258,2.657,0.586,5.311,1.086,7.947c0.706,3.685,1.685,7.298,3.227,10.725c1.562,3.464,3.748,6.474,6.565,9.013c0.793,0.701,1.556,1.46,2.317,2.202c0.387,0.378,0.747,0.8,1.037,1.268c0.551,0.873,0.348,0.831,1.646,1.067c0.096,0.02,0.182,0.024,0.28,0.045c1.945,0.326,3.866,0.814,5.754,1.387c1.392,0.436,2.401,1.288,3.072,2.558c0.204,0.377,0.386,0.766,0.548,1.161c0.416,1.013,0.691,2.068,0.903,3.152c0.176,0.898,0.307,1.801,0.378,2.705c0.07,0.792,0.171,0.895,0.974,1.082c0.265,0.059,0.531,0.11,0.808,0.167c2.075,0.468,4.14,0.989,6.125,1.784c0.765,0.303,1.498,0.674,2.187,1.139c0.778,0.511,1.257,1.198,1.354,2.151c0.075,0.789,0.188,1.578,0.296,2.354c0.416,3.047,0.821,6.089,1.241,9.132c0.163,1.171,0.295,2.356,0.55,3.519c0.223,1.057-0.025,1.924-0.726,2.694c-0.46,0.527-0.993,0.977-1.597,1.351c-0.979,0.612-2.016,1.121-3.093,1.559c-2.232,0.899-4.55,1.562-6.883,2.119c-4.181,0.991-8.415,1.676-12.677,2.201c-3.596,0.43-7.197,0.795-10.807,0.979c-0.946,0.048-1.892,0.105-2.827,0.177c-0.238,0.011-0.478,0.069-0.717,0.113c-7.913,0-15.826,0-23.744,0c-0.239-0.044-0.477-0.105-0.716-0.11c-1.917-0.069-3.825-0.23-5.733-0.365c-2.735-0.192-5.459-0.473-8.174-0.802c-3.29-0.414-6.567-0.916-9.817-1.586c-3.07-0.651-6.113-1.392-9.043-2.517c-1.427-0.553-2.804-1.188-4.057-2.084c-0.521-0.37-0.998-0.793-1.376-1.32c-0.438-0.614-0.686-1.298-0.52-2.062c0.282-1.335,0.415-2.704,0.608-4.055c0.29-2.045,0.547-4.102,0.824-6.158c0.239-1.777,0.49-3.551,0.724-5.328c0.081-0.638,0.36-1.157,0.834-1.581c0.388-0.343,0.822-0.621,1.276-0.872c0.672-0.354,1.37-0.663,2.087-0.914c1.521-0.545,3.071-0.991,4.646-1.341c0.414-0.087,0.834-0.18,1.245-0.288c0.572-0.159,0.664-0.271,0.724-0.886c0.055-0.605,0.092-1.215,0.138-1.82c0.117-1.376,0.396-2.704,0.873-4c0.613-1.656,1.625-2.911,3.321-3.539c0.087-0.03,0.169-0.076,0.251-0.106c1.483-0.553,2.974-1.086,4.525-1.422c0.776-0.164,1.55-0.32,2.329-0.438c0.499-0.079,0.82-0.316,1.04-0.783c0.439-0.935,1.064-1.758,1.776-2.521c0.599-0.654,1.193-1.3,1.787-1.955c1.667-1.832,3.083-3.838,4.199-6.059c1.28-2.539,2.193-5.213,2.897-7.961c0.746-2.892,1.257-5.827,1.625-8.789c0.274-2.174,0.479-4.349,0.63-6.539c0.086-1.305,0.107-2.614,0.199-3.917c0.211-2.983,0.119-5.96,0.147-8.943c0.003-0.444-0.065-0.832-0.411-1.163c-0.154-0.137-0.271-0.342-0.339-0.532c-0.138-0.407-0.386-0.672-0.822-0.761c-0.089-0.013-0.172-0.059-0.256-0.09c-0.529-0.202-0.839-0.581-0.976-1.127c-0.105-0.409-0.156-0.83-0.148-1.258c0.003-1.894,0.003-3.777,0.04-5.66c0.016-0.864,0.19-1.712,0.662-2.438c0.397-0.627,0.31-0.783-0.238-1.189c-0.025-0.021-0.051-0.043-0.075-0.055c-3.519-2.753-6.59-5.952-9.381-9.435c-3.692-4.586-6.803-9.56-9.634-14.72c-1.363-2.484-2.62-5.018-3.854-7.561c-0.101-0.2-0.142-0.462-0.432-0.607c0,0.195-0.017,0.345,0.007,0.49c0.131,0.848,0.081,1.694,0.001,2.545c-0.147,1.616-0.513,3.178-1.113,4.687c-0.263,0.654-0.596,1.267-1.042,1.819c-0.252,0.312-0.534,0.582-0.897,0.765c-0.719,0.354-1.401,0.144-1.786-0.554c-0.238-0.44-0.356-0.916-0.359-1.402c-0.002-0.481,0.01-0.976,0.069-1.453c0.103-0.788,0.244-1.563,0.379-2.35c0.186-1.043,0.343-2.097,0.29-3.169c-0.038-0.753-0.319-1.339-0.975-1.756c-0.614-0.389-1.205-0.825-1.804-1.238c-7.478-5.142-14.751-10.555-21.75-16.329c-4.294-3.545-8.436-7.264-12.432-11.148c-2.01-1.948-3.925-3.989-5.815-6.061c-3.406-3.735-6.57-7.666-9.447-11.831c-3.168-4.597-5.883-9.45-8.09-14.583c-1.905-4.424-3.383-8.996-4.581-13.657c-0.985-3.809-1.769-7.646-2.033-11.578c-0.032-0.544-0.08-1.095-0.268-1.615c0-1.218,0-2.435,0-3.652c0.19-0.646,0.239-1.319,0.282-1.983c0.18-2.559,0.62-5.071,1.298-7.541c0.919-3.311,2.275-6.419,4.257-9.238c1.087-1.551,2.327-2.967,3.821-4.146c1.224-0.973,2.534-1.8,4.048-2.246c1.817-0.532,3.697-0.751,5.588-0.739c2.193,0.014,4.264,0.591,6.235,1.558c1.835,0.901,3.556,1.99,5.233,3.152c1.776,1.231,3.534,2.488,5.287,3.744c0.683,0.487,1.411,0.846,2.221,1.031c1.267,0.29,2.54,0.301,3.806,0.041c1.261-0.261,1.54-0.598,1.682-1.895c0.045-0.457,0.092-0.91,0.187-1.357c0.147-0.693,0.454-1.261,1.282-1.325c0.25-0.018,0.371-0.199,0.382-0.438c0.008-0.211,0.016-0.425,0.003-0.637c-0.042-0.729-0.121-1.456-0.144-2.184c-0.067-2.22-0.264-4.434-0.243-6.656c0.002-0.616-0.093-1.212-0.265-1.801c-0.129-0.435-0.233-0.885-0.285-1.336c-0.137-1.197,0.271-1.358,1.093-1.505c4.012-0.716,8.033-1.392,12.068-1.97c2.621-0.371,5.242-0.729,7.865-1.048c2.447-0.3,4.896-0.542,7.351-0.797c1.448-0.153,2.903-0.284,4.358-0.405c1.91-0.163,3.821-0.328,5.729-0.467c1.273-0.099,2.551-0.158,3.824-0.236c2.674-0.159,5.345-0.365,8.017-0.465c2.582-0.1,5.165-0.265,7.754-0.248C245.911,171.135,246.25,171.136,246.567,171zM152.882,214.361c-0.063,2.239,0.133,4.577,0.444,6.896c0.724,5.362,2.088,10.56,4.069,15.598c0.834,2.122,1.792,4.194,2.759,6.261c1.545,3.308,3.105,6.606,4.848,9.82c3.989,7.374,8.866,14.107,14.602,20.218c3.171,3.375,6.545,6.537,10.077,9.529c6.697,5.676,13.856,10.721,21.258,15.426c0.181,0.111,0.367,0.216,0.553,0.317c0.107,0.057,0.247,0.095,0.331-0.021c0.048-0.057,0.054-0.177,0.027-0.253c-0.095-0.282-0.21-0.568-0.323-0.849c-2.471-5.964-4.678-12.018-6.662-18.164c-2.028-6.281-3.837-12.63-5.47-19.029c-1.417-5.538-2.675-11.119-3.827-16.725c-0.936-4.557-1.781-9.134-2.551-13.726c-0.691-4.105-1.322-8.229-1.875-12.36c-0.266-1.988-0.516-3.982-0.756-5.972c-0.23-1.938-0.453-3.87-0.654-5.805c-0.207-1.905-0.379-3.813-0.565-5.719c-0.004-0.063-0.013-0.126-0.024-0.183c-0.042-0.212-0.215-0.326-0.399-0.236c-0.19,0.091-0.374,0.2-0.56,0.302c-0.567,0.305-1.159,0.552-1.781,0.705c-1.362,0.344-2.746,0.535-4.146,0.591c-1.946,0.081-3.81-0.34-5.613-1.033c-1.515-0.582-2.936-1.335-4.36-2.102c-1.684-0.91-3.339-1.879-5.112-2.62c-0.764-0.317-1.544-0.558-2.355-0.702c-0.489-0.081-0.966-0.078-1.455-0.002c-0.91,0.134-1.77,0.438-2.629,0.747c-1.417,0.512-2.529,1.39-3.409,2.628c-1.968,2.745-3.173,5.81-3.855,9.091C152.979,209.384,152.823,211.811,152.882,214.361zM294.15,299.328c0.274,0.023,0.448-0.176,0.642-0.305c5.793-3.773,11.434-7.75,16.827-12.08c4.72-3.795,9.236-7.822,13.415-12.224c4.604-4.846,8.717-10.063,12.237-15.75c2.028-3.259,3.881-6.618,5.501-10.095c1.11-2.369,2.188-4.754,3.281-7.131c1.565-3.404,2.877-6.909,3.894-10.513c1.238-4.35,2.026-8.782,2.276-13.291c0.177-2.979,0.122-5.958-0.329-8.923c-0.636-4.168-2.117-7.979-4.713-11.335c-0.766-0.983-1.689-1.736-2.854-2.202c-0.767-0.306-1.54-0.565-2.35-0.742c-1.243-0.277-2.469-0.263-3.688,0.145c-1.159,0.387-2.267,0.89-3.332,1.473c-1.156,0.63-2.295,1.269-3.438,1.903c-1.141,0.634-2.299,1.249-3.499,1.765c-2.472,1.057-5.013,1.717-7.722,1.356c-0.126-0.02-0.241-0.013-0.366-0.024c-1.035-0.081-2.057-0.263-3.042-0.592c-0.167-0.057-0.343-0.123-0.513-0.163c-0.237-0.06-0.423,0.066-0.488,0.303c-0.032,0.147-0.043,0.297-0.06,0.451c-0.127,1.576-0.22,3.153-0.366,4.728c-0.248,2.91-0.483,5.821-0.797,8.722c-0.391,3.57-0.802,7.138-1.278,10.69c-0.845,6.336-1.871,12.638-3.059,18.92c-1.098,5.86-2.368,11.684-3.798,17.471c-1.242,5.024-2.639,10.002-4.17,14.948c-1.67,5.411-3.525,10.749-5.622,16.01c-0.783,1.947-1.627,3.87-2.428,5.81C294.23,298.863,294.028,299.061,294.15,299.328z'),
        winningMessage : new Path2D('M183.055,316.953l-2.756,8.268l-0.729,0.364c-0.832-0.485-1.819-0.875-2.964-1.17c-1.144-0.294-2.219-0.442-3.224-0.442c-2.635,0-4.498,0.832-5.59,2.496c-1.093,1.664-1.639,4.316-1.639,7.957c0,2.53,0.459,4.385,1.378,5.563s2.349,1.769,4.29,1.769c2.288,0,4.489-0.365,6.604-1.093l0.728,0.468l-1.819,8.217c-2.15,0.658-4.438,0.987-6.864,0.987c-4.992,0-8.814-1.229-11.466-3.692c-2.652-2.461-3.979-5.979-3.979-10.555c0-6.449,1.672-11.484,5.019-15.107c3.345-3.621,8.103-5.434,14.273-5.434C177.612,315.549,180.524,316.018,183.055,316.953zM201.67,327.898c1.387,1.578,2.08,3.649,2.08,6.215c0,4.923-1.283,8.806-3.848,11.648c-2.566,2.842-6.103,4.385-10.608,4.627l-0.832-0.104c-5.2-1.178-7.8-4.523-7.8-10.036c0-3.05,0.589-5.72,1.768-8.008s2.852-4.091,5.019-5.408c2.166-1.317,4.723-2.062,7.67-2.235l0.832,0.104C198.376,325.256,200.284,326.322,201.67,327.898zM190.829,332.527c-0.538,0.572-0.893,1.465-1.066,2.678c-0.174,1.214-0.26,2.964-0.26,5.252c0,1.18,0.112,1.984,0.338,2.418s0.667,0.65,1.326,0.65c1.074,0,1.863-0.286,2.366-0.858c0.502-0.571,0.84-1.464,1.014-2.678c0.173-1.214,0.26-2.981,0.26-5.304c0-1.145-0.104-1.933-0.312-2.366c-0.208-0.433-0.607-0.65-1.196-0.65C192.189,331.669,191.366,331.955,190.829,332.527zM228.502,327.249c1.353,1.04,2.01,2.254,1.976,3.64l-0.052,0.729l-1.976,11.96l-0.208,5.824l-9.464,0.571l2.288-13.728l0.052-0.521c0-0.762-0.295-1.144-0.884-1.144c-1.145,0-2.878,1.82-5.2,5.46l-0.468,3.691l-0.208,5.669l-9.204,0.571l2.443-18.512l0.208-5.876l9.204-0.571l-0.884,6.812h0.78c1.976-2.565,3.952-4.784,5.928-6.656l0.676-0.052C225.487,325.499,227.151,326.209,228.502,327.249zM253.514,342.85l-0.156,4.315c-0.346,2.738-1.187,5.07-2.521,6.994c-1.335,1.924-2.999,3.371-4.992,4.342c-1.994,0.97-4.169,1.456-6.526,1.456c-3.119,0-5.529-0.789-7.228-2.365c-1.698-1.578-2.738-3.649-3.12-6.215l0.208-0.572l6.864-2.859l0.052-0.624c-2.011-1.456-3.016-3.744-3.016-6.864c0-2.184,0.45-4.307,1.352-6.37c0.901-2.062,2.262-3.907,4.082-5.538c1.82-1.629,4.013-2.859,6.578-3.691h0.312l4.784,0.832l5.148-1.092l0.572,0.416L253.514,342.85zM243.504,352.625c0.676-0.624,1.066-1.561,1.17-2.809l0.936-7.02h-0.676c-1.387,2.323-2.912,4.352-4.576,6.084l-1.195,1.04c-0.556,0.485-0.832,0.988-0.832,1.509c0,0.588,0.208,1.092,0.624,1.508s1.057,0.623,1.924,0.623C241.953,353.561,242.829,353.249,243.504,352.625zM240.827,337.285c0,2.531,0.381,3.796,1.144,3.796c1.04,0,2.687-2.601,4.94-7.8l0.155-1.352l-3.275-0.781C241.814,331.148,240.827,333.195,240.827,337.285zM275.926,336.557l-0.832,0.364l-1.873-0.364c-1.145,0.07-2.141,0.295-2.99,0.676c-0.85,0.383-1.775,1.041-2.781,1.977l-0.572,4.523l-0.207,5.669l-9.205,0.571l2.443-18.512l0.209-5.876l9.203-0.571l-0.832,6.447h0.885c1.871-2.877,4.039-5.009,6.5-6.396l1.508,0.261L275.926,336.557zM298.545,343.732l-0.207,5.669l-9.203,0.571l0.779-5.72h-0.832c-1.215,2.427-2.496,4.455-3.848,6.084h-1.197c-2.703-0.657-4.576-1.707-5.615-3.146c-1.041-1.438-1.561-3.303-1.561-5.59c0-2.219,0.451-4.429,1.352-6.631c0.902-2.201,2.289-4.193,4.16-5.979c1.873-1.785,4.195-3.146,6.969-4.082h0.363l5.045,0.884l5.668-1.195l0.572,0.416L298.545,343.732zM291.318,333.697l0.156-1.145l-3.537-0.884c-1.699,0-2.547,2.028-2.547,6.084c0,2.739,0.363,4.108,1.092,4.108C287.486,341.861,289.1,339.141,291.318,333.697zM313.781,341.602c0,0.312,0.172,0.468,0.52,0.468c0.484,0,1.039-0.521,1.664-1.56l1.195,0.051l2.549,3.172c-1.803,2.705-3.779,4.854-5.928,6.449l-0.936,0.104c-2.809-0.312-4.828-0.9-6.059-1.768s-1.881-2.306-1.951-4.316l0.156-1.561l1.664-11.336l0.053-0.363h-3.225l-0.467-0.572l0.57-4.68h3.641l0.52-5.045l8.789-1.976l0.623,0.521l-0.988,6.5h5.098l0.623,0.728l-0.572,4.524h-5.928l-1.561,10.191L313.781,341.602zM340.926,326.053l-2.133,7.176l-1.195,0.469c-0.902-0.901-1.865-1.612-2.887-2.133c-1.023-0.52-1.898-0.779-2.625-0.779c-0.832,0-1.248,0.33-1.248,0.988c0,0.416,0.215,0.789,0.648,1.117c0.434,0.33,1.119,0.737,2.055,1.223c1.145,0.624,2.098,1.205,2.859,1.742c0.764,0.537,1.43,1.257,2.002,2.158s0.859,1.993,0.859,3.275c0,1.734-0.521,3.285-1.561,4.654c-1.041,1.369-2.463,2.443-4.264,3.224c-1.803,0.78-3.797,1.17-5.98,1.17c-2.635-0.278-5.062-0.728-7.279-1.352l2.184-7.54l0.936-0.469c0.971,1.11,2.062,1.985,3.275,2.627s2.289,0.961,3.225,0.961c0.451,0,0.789-0.104,1.014-0.312s0.338-0.433,0.338-0.676c0-0.347-0.217-0.685-0.648-1.015c-0.436-0.328-1.119-0.754-2.055-1.273c-1.248-0.693-2.262-1.326-3.043-1.898c-0.779-0.571-1.455-1.291-2.027-2.158c-0.572-0.865-0.857-1.889-0.857-3.067c0.068-1.94,0.658-3.614,1.768-5.019c1.109-1.403,2.574-2.478,4.395-3.223c1.82-0.746,3.803-1.119,5.953-1.119C336.748,325.014,338.846,325.43,340.926,326.053zM350.441,345.812c0,2.012-0.633,3.936-1.898,5.772s-3.25,3.692-5.953,5.563l-3.172-2.756l-0.105-0.728c1.941-1.698,2.912-3.588,2.912-5.668c0-1.456-0.572-2.738-1.715-3.849l0.051-0.832c2.496-1.385,4.975-2.391,7.436-3.016C349.627,341.896,350.441,343.732,350.441,345.812zM177.049,392.926l-0.624,8.84h-10.349l1.561-8.84l0.155-1.925l-7.903-22.88h10.815l0.468,2.809l2.549,10.191h0.624l5.668-9.828l1.56-3.172h10.608l-14.82,23.036L177.049,392.926zM206.689,379.898c1.387,1.578,2.08,3.649,2.08,6.215c0,4.923-1.283,8.806-3.848,11.648c-2.566,2.842-6.103,4.385-10.608,4.627l-0.832-0.104c-5.2-1.178-7.8-4.523-7.8-10.036c0-3.05,0.589-5.72,1.768-8.008s2.852-4.091,5.019-5.408c2.166-1.317,4.723-2.062,7.67-2.235l0.832,0.104C203.395,377.256,205.302,378.322,206.689,379.898zM195.847,384.527c-0.538,0.572-0.893,1.465-1.066,2.678c-0.174,1.214-0.26,2.964-0.26,5.252c0,1.18,0.112,1.984,0.338,2.418s0.667,0.65,1.326,0.65c1.074,0,1.863-0.286,2.366-0.858c0.502-0.571,0.84-1.464,1.014-2.678c0.173-1.214,0.26-2.981,0.26-5.304c0-1.145-0.104-1.933-0.312-2.366c-0.208-0.433-0.607-0.65-1.196-0.65C197.208,383.669,196.384,383.955,195.847,384.527zM232.844,395.732l-0.208,5.669l-9.204,0.571l0.832-6.291h-0.676c-1.769,2.426-3.571,4.506-5.408,6.239l-0.676,0.052c-2.22-0.242-3.97-0.875-5.252-1.897c-1.283-1.022-1.925-2.279-1.925-3.771l0.104-1.039l1.924-11.752l0.208-5.824l9.412-0.572l-2.184,13.624l-0.053,0.676c0,0.798,0.312,1.196,0.937,1.196c1.005,0,2.548-1.646,4.628-4.939l0.572-4.213l0.208-5.876l9.204-0.571L232.844,395.732zM262.641,401.766l-0.572-12.168h-0.779l-4.057,12.168h-10.088l-2.808-24.232l9.099-0.52v4.523l0.156,9.932h0.781l3.119-9.308l1.404-4.94h9.775l0.053,4.316l0.26,9.88h0.729l1.871-4.784c0.867-2.148,1.301-3.796,1.301-4.939c0-1.04-0.227-2.01-0.676-2.912l0.416-0.885l8.424-1.039c0.484,1.387,0.727,2.738,0.727,4.056c0,2.219-0.797,4.888-2.391,8.008l-6.5,12.845H262.641zM302.473,379.898c1.387,1.578,2.08,3.649,2.08,6.215c0,4.923-1.283,8.806-3.848,11.648c-2.566,2.842-6.104,4.385-10.609,4.627l-0.832-0.104c-5.199-1.178-7.799-4.523-7.799-10.036c0-3.05,0.588-5.72,1.768-8.008c1.178-2.288,2.852-4.091,5.018-5.408s4.723-2.062,7.67-2.235l0.832,0.104C299.178,377.256,301.086,378.322,302.473,379.898zM291.631,384.527c-0.539,0.572-0.893,1.465-1.066,2.678c-0.174,1.214-0.26,2.964-0.26,5.252c0,1.18,0.111,1.984,0.338,2.418c0.225,0.434,0.666,0.65,1.326,0.65c1.074,0,1.863-0.286,2.365-0.858c0.502-0.571,0.84-1.464,1.014-2.678s0.26-2.981,0.26-5.304c0-1.145-0.104-1.933-0.311-2.366c-0.209-0.433-0.607-0.65-1.197-0.65C292.99,383.669,292.168,383.955,291.631,384.527zM329.303,379.249c1.354,1.04,2.01,2.254,1.977,3.64l-0.053,0.729l-1.975,11.96l-0.209,5.824l-9.463,0.571l2.287-13.728l0.053-0.521c0-0.762-0.295-1.144-0.885-1.144c-1.145,0-2.877,1.82-5.199,5.46l-0.469,3.691l-0.207,5.669l-9.205,0.571l2.443-18.512l0.209-5.876l9.203-0.571l-0.883,6.812h0.779c1.977-2.565,3.953-4.784,5.928-6.656l0.676-0.052C326.287,377.499,327.951,378.209,329.303,379.249zM342.979,393.237c0.832,0.866,1.248,2.063,1.248,3.588c0,1.664-0.467,2.981-1.404,3.952c-0.936,0.971-2.201,1.455-3.795,1.455c-1.596,0-2.809-0.424-3.641-1.273s-1.248-2.07-1.248-3.666c0-1.629,0.477-2.929,1.43-3.9c0.953-0.97,2.244-1.455,3.875-1.455C340.969,391.938,342.146,392.371,342.979,393.237zM343.395,388.297l-5.719,0.832l-0.885-0.936l1.561-19.656l0.988-1.145l8.215-0.571l1.041,1.196L343.395,388.297zM194.46,425.205l-0.2,0.9l-0.159,0.02c-0.694-0.48-1.421-0.72-2.181-0.72c-0.866,0-1.55,0.343-2.05,1.03c-0.5,0.687-0.75,1.623-0.75,2.81c0,1.16,0.253,2.08,0.76,2.761c0.507,0.68,1.2,1.02,2.08,1.02c0.854,0,1.653-0.254,2.4-0.76l0.14,0.08l-0.1,0.879c-0.813,0.44-1.66,0.66-2.54,0.66c-1.147,0-2.054-0.412-2.72-1.24c-0.667-0.826-1-1.945-1-3.359c0-1.453,0.34-2.609,1.02-3.471c0.68-0.859,1.606-1.289,2.78-1.289C192.874,424.525,193.713,424.752,194.46,425.205zM197.84,433.766h-1.021l0.061-3.9l-0.061-10.04l1.04-0.101l-0.08,10.08L197.84,433.766zM202.701,421.465c0,0.467-0.228,0.7-0.681,0.7c-0.439,0-0.66-0.22-0.66-0.659c0-0.214,0.061-0.384,0.181-0.511c0.12-0.126,0.286-0.19,0.5-0.19C202.48,420.805,202.701,421.025,202.701,421.465zM202.52,433.766h-1.02l0.06-3.9l-0.06-5.12l1.04-0.12l-0.08,5.18L202.52,433.766zM211.64,425.205l-0.2,0.9l-0.159,0.02c-0.694-0.48-1.421-0.72-2.181-0.72c-0.866,0-1.55,0.343-2.05,1.03c-0.5,0.687-0.75,1.623-0.75,2.81c0,1.16,0.253,2.08,0.76,2.761c0.507,0.68,1.2,1.02,2.08,1.02c0.854,0,1.653-0.254,2.4-0.76l0.14,0.08l-0.1,0.879c-0.813,0.44-1.66,0.66-2.54,0.66c-1.147,0-2.054-0.412-2.72-1.24c-0.667-0.826-1-1.945-1-3.359c0-1.453,0.34-2.609,1.02-3.471c0.68-0.859,1.606-1.289,2.78-1.289C210.053,424.525,210.893,424.752,211.64,425.205zM215.02,433.766H214l0.061-3.9L214,419.825l1.04-0.101l-0.08,10.08L215.02,433.766zM220.719,433.564v0.141c-0.119,0.054-0.42,0.127-0.899,0.221l-0.141-0.041c-1.653-1.786-3.06-3.42-4.22-4.899v-0.12l3.18-3.46l0.561-0.74h1.24l-3.9,4.2C217.78,430.385,219.172,431.952,220.719,433.564zM230.699,425.145c0.453,0.414,0.68,0.987,0.68,1.721c0-0.187-0.033,0.674-0.1,2.58c-0.08,1.52-0.12,2.38-0.12,2.58c0,0.347,0.05,0.59,0.15,0.73c0.1,0.139,0.27,0.209,0.51,0.209s0.493-0.066,0.76-0.199l0.141,0.1l-0.12,0.66c-0.32,0.199-0.66,0.307-1.021,0.32c-0.8-0.027-1.22-0.527-1.26-1.5h-0.1c-0.761,0.866-1.547,1.379-2.36,1.539c-0.8,0-1.427-0.209-1.88-0.629c-0.453-0.421-0.68-1.004-0.68-1.75c0-1.08,0.586-1.754,1.76-2.021l3.319-0.78l0.04-1.62c0-0.573-0.153-1.01-0.46-1.31c-0.307-0.301-0.739-0.45-1.3-0.45c-0.854,0-1.787,0.434-2.8,1.3l-0.12-0.061l-0.16-0.739c1.094-0.866,2.167-1.3,3.221-1.3C229.612,424.525,230.246,424.732,230.699,425.145zM226.239,431.385c0,0.508,0.14,0.904,0.42,1.19s0.667,0.431,1.16,0.431c0.813,0,1.633-0.541,2.46-1.621l0.08-1.939l-3.1,0.74C226.579,430.346,226.239,430.745,226.239,431.385zM240.489,425.975c-0.327-0.353-0.79-0.529-1.391-0.529c-1,0-1.979,0.553-2.939,1.66l-0.021,2.699l0.061,3.961h-1.04l0.06-3.9l-0.04-5.12l0.98-0.12v1.46h0.1c0.946-0.92,1.887-1.433,2.82-1.54c0.92,0,1.626,0.237,2.12,0.711c0.493,0.473,0.732,1.143,0.72,2.01l-0.021,2.56l0.04,3.94h-1.04l0.061-6.301C240.971,426.825,240.815,426.328,240.489,425.975zM247.199,432.485h0.12l2.54-6.74l0.3-1.08h1l-3.38,8.92c-0.319,0.853-0.673,1.536-1.06,2.05s-0.847,0.92-1.38,1.221c-0.533,0.299-1.2,0.537-2,0.709h-0.12c-0.2-0.172-0.36-0.387-0.48-0.639l0.04-0.16c1.08-0.215,1.907-0.531,2.48-0.951s1.073-1.104,1.5-2.049l-3.34-9.061l1.02-0.1l0.28,1.06L247.199,432.485zM255.098,432.564h0.102l2.219-6.859l0.301-1.04h1.039l0.221,1l1.939,6.899h0.1l2.24-6.859l0.281-1.04h0.959l-3.08,9.101h-1.02l-2.16-7.681h-0.119l-2.5,7.681h-1.041l-2.62-9.061l0.96-0.1l0.24,1.06L255.098,432.564zM272.678,425.256c0.494,0.473,0.734,1.143,0.721,2.01l-0.041,2.56l0.041,3.94h-1.041l0.08-6.301c0-0.64-0.162-1.137-0.488-1.49c-0.328-0.353-0.791-0.529-1.391-0.529c-0.975,0-1.953,0.553-2.939,1.66l-0.021,2.699l0.061,3.961h-1.02l0.061-3.9l-0.061-10.04l1.039-0.101l-0.059,6.36h0.119c0.947-0.92,1.881-1.433,2.801-1.54C271.471,424.545,272.186,424.782,272.678,425.256zM282.268,425.436c0.541,0.594,0.811,1.402,0.811,2.43l-0.041,0.76l-0.238,0.2l-5.82,0.101v0.319c0,1.173,0.256,2.097,0.77,2.771c0.514,0.673,1.25,1.01,2.211,1.01c0.945,0,1.799-0.301,2.559-0.9l0.16,0.061l-0.119,0.899c-0.828,0.534-1.721,0.8-2.68,0.8c-1.215,0-2.164-0.41-2.852-1.229c-0.686-0.82-1.029-1.937-1.029-3.351c0-1.467,0.363-2.626,1.09-3.479c0.727-0.853,1.703-1.28,2.93-1.28C280.979,424.545,281.729,424.842,282.268,425.436zM281.549,425.955c-0.395-0.42-0.932-0.63-1.611-0.63c-0.76,0-1.393,0.25-1.9,0.75c-0.506,0.5-0.832,1.196-0.979,2.09l5.039-0.14l0.041-0.26C282.139,426.979,281.941,426.375,281.549,425.955zM289.918,424.686v1l-0.141,0.039c-0.24-0.039-0.453-0.06-0.641-0.06c-0.879,0-1.713,0.808-2.5,2.42v1.72l0.061,3.961h-1.039l0.059-3.9l-0.039-5.12l0.98-0.12v2.04h0.1c0.76-1.347,1.639-2.021,2.639-2.021C289.557,424.645,289.73,424.658,289.918,424.686zM297.168,425.436c0.539,0.594,0.809,1.402,0.809,2.43l-0.039,0.76l-0.24,0.2l-5.82,0.101v0.319c0,1.173,0.258,2.097,0.771,2.771c0.512,0.673,1.25,1.01,2.209,1.01c0.947,0,1.801-0.301,2.561-0.9l0.16,0.061l-0.121,0.899c-0.826,0.534-1.719,0.8-2.68,0.8c-1.213,0-2.164-0.41-2.85-1.229c-0.688-0.82-1.029-1.937-1.029-3.351c0-1.467,0.361-2.626,1.09-3.479c0.727-0.853,1.703-1.28,2.93-1.28C295.877,424.545,296.627,424.842,297.168,425.436zM296.447,425.955c-0.393-0.42-0.93-0.63-1.609-0.63c-0.76,0-1.395,0.25-1.9,0.75c-0.508,0.5-0.834,1.196-0.98,2.09l5.041-0.14l0.039-0.26C297.037,426.979,296.84,426.375,296.447,425.955zM307.977,432.506l0.121,0.1l-0.1,0.72c-0.668,0.347-1.268,0.526-1.801,0.54c-1.359-0.16-2.039-0.986-2.039-2.48l0.039-1.8l-0.02-4.159h-1.24l-0.08-0.101l0.08-0.64h1.24v-1.82l0.879-0.359l0.121,0.1l-0.02,2.08h2.898l0.08,0.1l-0.08,0.641h-2.898l-0.061,5.859c0,1.12,0.459,1.68,1.379,1.68C306.943,432.965,307.443,432.812,307.977,432.506zM315.826,425.735c0.674,0.807,1.012,1.93,1.012,3.37c0,1.506-0.354,2.68-1.061,3.52s-1.688,1.26-2.939,1.26c-1.201,0-2.135-0.402-2.801-1.209s-1-1.924-1-3.351c0-1.507,0.35-2.683,1.051-3.53c0.699-0.846,1.676-1.27,2.93-1.27C314.217,424.525,315.154,424.929,315.826,425.735zM310.797,426.305c-0.52,0.668-0.779,1.607-0.779,2.82c0,1.28,0.25,2.264,0.75,2.95s1.203,1.03,2.109,1.03c0.947,0,1.68-0.33,2.199-0.99c0.521-0.66,0.781-1.597,0.781-2.811c0-1.279-0.254-2.266-0.76-2.959c-0.508-0.693-1.215-1.041-2.121-1.041C312.043,425.305,311.316,425.639,310.797,426.305zM219.86,449.715c0.601,0.768,0.9,1.85,0.9,3.25c0,1.574-0.38,2.787-1.14,3.641c-0.761,0.854-1.834,1.279-3.221,1.279c-0.653,0-1.3-0.061-1.939-0.18l0.02,3.76h-1.02l0.06-7.6l-0.06-5.119l1-0.121v1.32h0.1c0.827-0.801,1.733-1.26,2.72-1.381C218.4,448.564,219.26,448.949,219.86,449.715zM218.911,456.074c0.579-0.686,0.869-1.676,0.869-2.969c0-1.174-0.223-2.076-0.67-2.711c-0.446-0.633-1.083-0.949-1.91-0.949c-0.973,0-1.887,0.506-2.739,1.52l-0.021,2.84l0.021,2.84c0.76,0.307,1.439,0.461,2.04,0.461C217.527,457.105,218.331,456.762,218.911,456.074zM224.621,457.766H223.6l0.061-3.9l-0.061-10.041l1.04-0.1l-0.08,10.08L224.621,457.766zM232.88,449.145c0.453,0.414,0.68,0.988,0.68,1.721c0-0.188-0.033,0.674-0.1,2.58c-0.08,1.52-0.12,2.379-0.12,2.58c0,0.346,0.05,0.59,0.15,0.73c0.1,0.139,0.27,0.209,0.51,0.209s0.493-0.066,0.76-0.199l0.141,0.1l-0.12,0.66c-0.32,0.199-0.66,0.307-1.021,0.32c-0.8-0.027-1.22-0.527-1.26-1.5h-0.1c-0.761,0.867-1.547,1.379-2.36,1.539c-0.8,0-1.427-0.209-1.88-0.629s-0.68-1.004-0.68-1.75c0-1.08,0.586-1.754,1.76-2.021l3.319-0.779l0.04-1.619c0-0.574-0.153-1.012-0.46-1.311c-0.307-0.301-0.739-0.451-1.3-0.451c-0.854,0-1.787,0.434-2.8,1.301l-0.12-0.061l-0.16-0.74c1.094-0.865,2.167-1.299,3.221-1.299C231.793,448.525,232.427,448.732,232.88,449.145zM228.42,455.385c0,0.508,0.14,0.904,0.42,1.189c0.28,0.287,0.667,0.432,1.16,0.432c0.813,0,1.633-0.541,2.46-1.621l0.08-1.939l-3.1,0.74C228.76,454.346,228.42,454.746,228.42,455.385zM239.2,456.484h0.12l2.54-6.738l0.3-1.08h1l-3.38,8.92c-0.319,0.852-0.673,1.535-1.06,2.049s-0.847,0.92-1.38,1.221c-0.533,0.299-1.2,0.537-2,0.709h-0.12c-0.2-0.172-0.36-0.387-0.48-0.639l0.04-0.16c1.08-0.215,1.907-0.531,2.48-0.951s1.073-1.104,1.5-2.049l-3.34-9.061l1.02-0.1l0.28,1.061L239.2,456.484zM253.279,449.145c0.453,0.414,0.68,0.988,0.68,1.721c0-0.188-0.033,0.674-0.1,2.58c-0.08,1.52-0.119,2.379-0.119,2.58c0,0.346,0.049,0.59,0.15,0.73c0.1,0.139,0.27,0.209,0.51,0.209s0.492-0.066,0.76-0.199l0.141,0.1l-0.121,0.66c-0.32,0.199-0.66,0.307-1.02,0.32c-0.801-0.027-1.22-0.527-1.26-1.5h-0.1c-0.761,0.867-1.547,1.379-2.36,1.539c-0.8,0-1.427-0.209-1.88-0.629s-0.68-1.004-0.68-1.75c0-1.08,0.586-1.754,1.76-2.021l3.319-0.779l0.04-1.619c0-0.574-0.153-1.012-0.46-1.311c-0.307-0.301-0.739-0.451-1.3-0.451c-0.854,0-1.787,0.434-2.8,1.301l-0.12-0.061l-0.16-0.74c1.094-0.865,2.167-1.299,3.221-1.299C252.193,448.525,252.827,448.732,253.279,449.145zM248.82,455.385c0,0.508,0.14,0.904,0.42,1.189c0.28,0.287,0.667,0.432,1.16,0.432c0.813,0,1.633-0.541,2.46-1.621l0.08-1.939l-3.1,0.74C249.16,454.346,248.82,454.746,248.82,455.385zM263.379,449.645l-0.02,0.061c0.387,0.508,0.58,1.146,0.58,1.92c0,0.961-0.303,1.723-0.91,2.291c-0.607,0.566-1.43,0.85-2.471,0.85c-0.492,0-0.959-0.074-1.398-0.221c-0.307,0.227-0.514,0.41-0.621,0.551c-0.107,0.139-0.16,0.275-0.16,0.41c0,0.293,0.191,0.502,0.57,0.629c0.381,0.127,0.977,0.25,1.791,0.371c0.785,0.119,1.432,0.246,1.939,0.379c0.506,0.135,0.939,0.348,1.299,0.641c0.361,0.293,0.541,0.693,0.541,1.199c0,0.521-0.188,1-0.561,1.441c-0.373,0.439-0.879,0.789-1.52,1.049s-1.334,0.391-2.08,0.391c-1.014,0-1.811-0.23-2.391-0.689c-0.58-0.461-0.869-1.051-0.869-1.771c0.254-0.746,0.887-1.412,1.9-2v-0.1c-1.08-0.279-1.621-0.779-1.621-1.5c0.174-0.387,0.574-0.787,1.201-1.199v-0.061c-0.854-0.533-1.281-1.387-1.281-2.561c0-0.986,0.305-1.76,0.91-2.32c0.607-0.559,1.43-0.84,2.471-0.84c0.721,0,1.332,0.141,1.84,0.42c1.119-0.213,2.033-0.42,2.74-0.619l0.119,0.08v0.76C264.766,449.365,264.1,449.512,263.379,449.645zM263.18,458.045c-0.268-0.199-0.598-0.346-0.99-0.439s-0.924-0.188-1.59-0.281c-0.146-0.012-0.367-0.045-0.66-0.1c-1.268,0.707-1.9,1.395-1.9,2.061c0,0.439,0.213,0.811,0.641,1.109c0.426,0.301,1.02,0.451,1.779,0.451c0.574,0,1.098-0.09,1.57-0.271c0.473-0.18,0.85-0.422,1.131-0.729c0.279-0.307,0.42-0.635,0.42-0.98C263.58,458.518,263.445,458.246,263.18,458.045zM262.359,453.375c0.426-0.42,0.641-1.004,0.641-1.75c0-0.732-0.203-1.301-0.611-1.699c-0.406-0.4-0.982-0.602-1.729-0.602c-0.76,0-1.354,0.207-1.781,0.621c-0.426,0.414-0.639,0.994-0.639,1.74c0,0.719,0.205,1.287,0.619,1.699c0.414,0.414,0.994,0.621,1.74,0.621S261.932,453.795,262.359,453.375zM271.639,449.145c0.453,0.414,0.68,0.988,0.68,1.721c0-0.188-0.033,0.674-0.1,2.58c-0.08,1.52-0.119,2.379-0.119,2.58c0,0.346,0.049,0.59,0.15,0.73c0.1,0.139,0.27,0.209,0.51,0.209s0.492-0.066,0.76-0.199l0.141,0.1l-0.121,0.66c-0.32,0.199-0.66,0.307-1.02,0.32c-0.801-0.027-1.221-0.527-1.26-1.5h-0.1c-0.762,0.867-1.547,1.379-2.361,1.539c-0.799,0-1.426-0.209-1.879-0.629s-0.68-1.004-0.68-1.75c0-1.08,0.586-1.754,1.76-2.021l3.318-0.779l0.041-1.619c0-0.574-0.154-1.012-0.461-1.311c-0.307-0.301-0.738-0.451-1.299-0.451c-0.854,0-1.787,0.434-2.801,1.301l-0.119-0.061l-0.16-0.74c1.094-0.865,2.166-1.299,3.221-1.299C270.553,448.525,271.186,448.732,271.639,449.145zM267.18,455.385c0,0.508,0.139,0.904,0.42,1.189c0.279,0.287,0.666,0.432,1.16,0.432c0.812,0,1.633-0.541,2.459-1.621l0.08-1.939l-3.1,0.74C267.52,454.346,267.18,454.746,267.18,455.385zM277.299,445.465c0,0.467-0.227,0.701-0.68,0.701c-0.439,0-0.66-0.221-0.66-0.66c0-0.213,0.061-0.385,0.18-0.51c0.121-0.127,0.287-0.191,0.5-0.191C277.078,444.805,277.299,445.025,277.299,445.465zM277.119,457.766h-1.02l0.059-3.9l-0.059-5.119l1.039-0.121l-0.08,5.18L277.119,457.766zM286.049,449.975c-0.326-0.354-0.789-0.529-1.391-0.529c-1,0-1.979,0.553-2.939,1.66l-0.02,2.699l0.061,3.961h-1.041l0.061-3.9l-0.041-5.119l0.98-0.121v1.461h0.1c0.947-0.92,1.887-1.434,2.82-1.541c0.92,0,1.627,0.236,2.121,0.711c0.492,0.473,0.732,1.143,0.719,2.01l-0.02,2.559l0.039,3.941h-1.039l0.061-6.301C286.531,450.824,286.375,450.328,286.049,449.975zM292.078,457.125c0,0.467-0.227,0.699-0.68,0.699c-0.439,0-0.66-0.219-0.66-0.658c0-0.215,0.061-0.385,0.18-0.512c0.121-0.125,0.287-0.189,0.5-0.189C291.859,456.465,292.078,456.686,292.078,457.125z')
      };
      graphic.circle.arc(252.5, 303, 180, 0, 2 * Math.PI);

      ctx.fillStyle = '#FCE991';
      ctx.fill(graphic.circle);
      ctx.fillStyle = '#ECBE3B';
      ctx.fill(graphic.goldCup);
      ctx.fillStyle = '#906A1F';
      ctx.fill(graphic.winningMessage);

      canvas.addEventListener('click', clearWinningScreen, false);
    }

    /*  Remove the message that states the user has won the game
     *  and reset the game
    */
    function clearWinningScreen(e) {
      // get the position and measurements of the canvas
      const canvasDOMRect = canvas.getBoundingClientRect();

      // if the user clicks within the canvas area, reset the game
      if((e.clientX > canvasDOMRect.left && e.clientX < canvasDOMRect.right) && (e.clientY > canvasDOMRect.top && e.clientY < canvasDOMRect.bottom)){
        resetGame();
        /* remove click eventListener so the user cannot reset the game again
         * until the next death or win
         */
        canvas.removeEventListener('click', clearWinningScreen, false);
      }
    }

    /* Go ahead and load all of the images we know we're going to need to
     * draw our game level. Then set init as the callback method, so that when
     * all of these images are properly loaded our game will start.
     */
    Resources.load([
        'images/stone-block.png',
        'images/water-block.png',
        'images/grass-block.png',
        'images/enemy-bug.png',
        'images/char-boy.png',
        'images/char-boy-dead.png'
    ]);
    Resources.onReady(init);

    /* Assign the canvas' context object to the global variable (the window
     * object when run in a browser) so that developers can use it more easily
     * from within their app.js files.
     */
    global.ctx = ctx;
})(this);
